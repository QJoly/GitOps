version: '3'
tasks:
  env:
    desc: "Generate dotenv file"
    cmds:
      - ./.scripts/parse_yaml.sh "{{.secret_file}}"
    preconditions: # do not start if fail
      - which yq >/dev/null
    status: # check if the task need to be runned
      - test -f .env
  clean:
    desc: "Clean everything"
    cmds:
      - rm .env
      - rm $(find . -type f -name "preseed.cfg")  
    preconditions: # do not start if fail
      - which yq >/dev/null
